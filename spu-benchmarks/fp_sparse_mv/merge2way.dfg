Input: A
Input: B
Input: C
Input: D
Input: I
Input: done

P = Index_match(A,B)
E = BackMul64(C,D,P)
R = Acc64(E,P)

nonzero = ICmpNE(R,0)

Val = Keep(R,nonzero)
Index = Keep(I,nonzero)
nz_count = Acc64(nonzero, done)

Output: Val
Output: Index
Output: nz_count
