InputVec: A [0, 1]
InputVec: B [0, 1]
Input: I
Input: done

P = Index_match(A0,B0)
E = Mul64(A1,B1)
R = Acc64(E,P)

nonzero = ICmpNE(R,0)


Val = Keep(R,nonzero)
Index = Keep(I,nonzero)
nz_count = Acc64(nonzero, done)

Output: Val
Output: Index
Output: nz_count

